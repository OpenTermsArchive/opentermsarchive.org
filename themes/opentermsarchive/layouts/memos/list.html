{{ define "main" }}
  {{ partial "hero.html" (dict "title" (.Params.hero.title | safeHTML) "subtitle" .Params.hero.subtitle "size" "109") }}
  <div class="container container--has-no-padding-y">
    <div class="container container--has-no-padding-top container--109">
      <div class="textcontent">

        {{/* Add a date parameter to each page, which takes the first date in the list of dates */}}
        {{ $pagesWithDateParam := slice }}
          {{ range .Pages }}
            {{ $firstDate := (index .Params.dates 0) | time }}
            {{ $pagesWithDateParam = $pagesWithDateParam | append (dict "date" $firstDate "page" .) }}
          {{ end }}

        {{/* Sort pages by date */}}
        {{ $sortedPages := sort $pagesWithDateParam "date" "desc" }}

        {{/* Extract Hugo pages object */}}
        {{ $sortedHugoPages := slice }}
        {{ range $sortedPages }}
          {{ $sortedHugoPages = $sortedHugoPages | append .page }}
        {{ end }}

        {{/* Paginate */}}
        {{ $paginator := .Paginate $sortedHugoPages 8 }}

        {{ range $paginator.Pages }}
          <div class="mb--xl">
            <h4 class="mb--0">
              <a href="{{ .RelPermalink }}">{{ .LinkTitle }}</a>
            </h4>
            <div class="text--smallcaps mt--2xs">
              {{ .Params.service }} ▪
              {{ delimit .Params.terms_types " , " }} ▪
              {{ $formatedDates := slice }}
              {{ range .Params.dates }}
                {{ $formatedDate := ( . | time.Format ":date_long") }}
                {{ $formatedDates = $formatedDates | append $formatedDate }}
              {{ end }}
              {{ delimit $formatedDates " - " }}
            </div>
            <hr class="mt--xl">
          </div>
        {{ end }}
      </div>
    </div>
  </div>
{{ end }}
